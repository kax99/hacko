<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="style.css">
</head>


<body>
   
      
    <div class="container">
        <h1>Physics Problem Solver</h1>

        <div class="section">
            <h2>Select Chapter</h2>
            <select id="chapterSelect" onchange="showChapterOptions()">
                <option value="" disabled selected>Select a chapter</option>
                <option value="optics">Light (Optics)</option>
                <option value="electricity">Electricity</option>
                <option value="thermodynamics">Thermodynamics</option>
                <option value="mechanics">Mechanics</option>
            </select>
        </div>

        <div id="opticsOptions" class="section" style="display:none;">
            <h2>Choose Optics Problem</h2>
            <select id="opticsProblemSelect" onchange="showOpticsInputs()">
                <option value="" disabled selected>Select an optics problem</option>
                <option value="lens">Lens Formula</option>
                <option value="mirror">Mirror Formula</option>
                <option value="snell">Snell's Law</option>
            </select>
            <div id="opticsInputs"></div>
        </div>

        <div id="electricityOptions" class="section" style="display:none;">
            <h2>Choose Electricity Problem</h2>
            <select id="electricityProblemSelect" onchange="showElectricityInputs()">
                <option value="" disabled selected>Select an electricity problem</option>
                <option value="ohm">Ohm's Law</option>
            </select>
            <div id="electricityInputs"></div>
        </div>
            
        <div id="thermodynamicsOptions" class="section" style="display:none;">
            <h2>Thermodynamics Problem</h2>
            <select id="thermodynamicsProblemSelect" onchange="showThermodynamicsInputs()">
              <option value="" disabled selected>Select a problem</option>
              <option value="newton">Newton's Law of Cooling (T(t) = Tₐ + (T₀ - Tₐ)e^(-kt))</option>
              <option value="idealgas">Ideal Gas Law (PV = nRT)</option>
              <option value="specificheat">Specific Heat (Q = mcΔT)</option>
              <option value="conduction">Heat Conduction (Q = kAΔTt/d)</option>
            </select>
            <div id="thermodynamicsInputs"></div>
          </div>
      
          <!-- Mechanics Options -->
          <div id="mechanicsOptions" class="section" style="display:none;">
            <h2>Mechanics Problem</h2>
            <select id="mechanicsProblemSelect" onchange="showMechanicsInputs()">
              <option value="" disabled selected>Select a problem</option>
              <option value="kinematic">Kinematic Equation (v = u + at)</option>
              <option value="workenergy">Work-Energy (W = Fd)</option>
              <option value="newton2">Newton's Second Law (F = ma)</option>
              <option value="energy">Kinetic Energy (KE = ½mv²)</option>
              <option value="potential">Potential Energy (U = mgh)</option>
            </select>
            <div id="mechanicsInputs"></div>
          </div>
      
          <!-- AI Input Section -->
          <div id="aiInputSection" class="section">
            <h2>Custom Problem (AI-Powered)</h2>
            <p>If your problem isn't listed, describe it or upload an image below.</p>
            <label for="problemDescription">Problem Description</label>
            <textarea id="problemDescription" placeholder="e.g., A 2 kg object accelerates at 3 m/s². Find the force."></textarea>
            <label for="problemImage">Upload Problem Image</label>
            <input type="file" id="problemImage" accept="image/*">
          </div>
      
          <!-- Solve Button -->
          <button onclick="solveProblem()">Solve Problem</button>
      
          <!-- Output Sections -->
          <div id="steps" class="step-container" style="display:none;"></div>
          <div id="result" class="result" style="display:none;"></div>
        </div>
        <script>
            
            const API_KEY = 'AIzaSyC6c67uTYOsefWSDf5Q7ZMY4CNDRSECpCM';
        
            // Show chapter-specific options
            function showChapterOptions() {
              const chapter = document.getElementById("chapterSelect").value;
              document.getElementById("opticsOptions").style.display = chapter === "optics" ? "block" : "none";
              document.getElementById("electricityOptions").style.display = chapter === "electricity" ? "block" : "none";
              document.getElementById("thermodynamicsOptions").style.display = chapter === "thermodynamics" ? "block" : "none";
              document.getElementById("mechanicsOptions").style.display = chapter === "mechanics" ? "block" : "none";
              document.getElementById("steps").style.display = "none";
              document.getElementById("result").style.display = "none";
        
    
            }
            function showOpticsInputs() {
      const problemType = document.getElementById("opticsProblemSelect").value;
      let inputsHtml = "";
      if (problemType === "lens" || problemType === "mirror") {
        inputsHtml += '<label>Object Distance (u)</label><input type="number" id="u" placeholder="in meters">';
        inputsHtml += '<label>Image Distance (v)</label><input type="number" id="v" placeholder="in meters">';
        inputsHtml += '<label>Focal Length (f)</label><input type="number" id="f" placeholder="in meters">';
      } else if (problemType === "snell") {
        inputsHtml += '<label>n₁</label><input type="number" id="n1" placeholder="Refractive index 1">';
        inputsHtml += '<label>θ₁ (degrees)</label><input type="number" id="theta1" placeholder="Angle of incidence">';
        inputsHtml += '<label>n₂</label><input type="number" id="n2" placeholder="Refractive index 2">';
        inputsHtml += '<label>θ₂ (degrees)</label><input type="number" id="theta2" placeholder="Angle of refraction">';
      } else if (problemType === "magnification") {
        inputsHtml += '<label>Image Distance (v)</label><input type="number" id="v_mag" placeholder="in meters">';
        inputsHtml += '<label>Object Distance (u)</label><input type="number" id="u_mag" placeholder="in meters">';
      } else if (problemType === "lensmaker") {
        inputsHtml += '<label>Refractive Index (n)</label><input type="number" id="n_lens" placeholder="e.g., 1.5">';
        inputsHtml += '<label>R₁</label><input type="number" id="R1" placeholder="in meters">';
        inputsHtml += '<label>R₂</label><input type="number" id="R2" placeholder="in meters">';
      }
      document.getElementById("opticsInputs").innerHTML = inputsHtml;
    }

    function showElectricityInputs() {
      const problemType = document.getElementById("electricityProblemSelect").value;
      let inputsHtml = "";
      if (problemType === "ohm") {
        inputsHtml += '<label>Voltage (V)</label><input type="number" id="V" placeholder="in volts">';
        inputsHtml += '<label>Current (I)</label><input type="number" id="I" placeholder="in amperes">';
        inputsHtml += '<label>Resistance (R)</label><input type="number" id="R" placeholder="in ohms">';
      } else if (problemType === "power") {
        inputsHtml += '<label>Voltage (V)</label><input type="number" id="V_pow" placeholder="in volts">';
        inputsHtml += '<label>Current (I)</label><input type="number" id="I_pow" placeholder="in amperes">';
      } else if (problemType === "series") {
        inputsHtml += '<label>R₁</label><input type="number" id="R1_ser" placeholder="in ohms">';
        inputsHtml += '<label>R₂</label><input type="number" id="R2_ser" placeholder="in ohms">';
      } else if (problemType === "parallel") {
        inputsHtml += '<label>R₁</label><input type="number" id="R1_par" placeholder="in ohms">';
        inputsHtml += '<label>R₂</label><input type="number" id="R2_par" placeholder="in ohms">';
      }
      document.getElementById("electricityInputs").innerHTML = inputsHtml;
    }

    function showThermodynamicsInputs() {
      const problemType = document.getElementById("thermodynamicsProblemSelect").value;
      let inputsHtml = "";
      if (problemType === "newton") {
        inputsHtml += '<label>Ambient Temp (Tₐ)</label><input type="number" id="T_ambient" placeholder="in °C">';
        inputsHtml += '<label>Initial Temp (T₀)</label><input type="number" id="T0" placeholder="in °C">';
        inputsHtml += '<label>Cooling Constant (k)</label><input type="number" id="k" placeholder="in s⁻¹">';
        inputsHtml += '<label>Time (t)</label><input type="number" id="time" placeholder="in seconds">';
      } else if (problemType === "idealgas") {
        inputsHtml += '<label>Pressure (P)</label><input type="number" id="P" placeholder="in Pa">';
        inputsHtml += '<label>Volume (V)</label><input type="number" id="V_gas" placeholder="in m³">';
        inputsHtml += '<label>Moles (n)</label><input type="number" id="n" placeholder="in mol">';
      } else if (problemType === "specificheat") {
        inputsHtml += '<label>Mass (m)</label><input type="number" id="m_sh" placeholder="in kg">';
        inputsHtml += '<label>Specific Heat (c)</label><input type="number" id="c" placeholder="in J/kg°C">';
        inputsHtml += '<label>ΔT</label><input type="number" id="deltaT" placeholder="in °C">';
      } else if (problemType === "conduction") {
        inputsHtml += '<label>Thermal Conductivity (k)</label><input type="number" id="k_cond" placeholder="in W/m°C">';
        inputsHtml += '<label>Area (A)</label><input type="number" id="A" placeholder="in m²">';
        inputsHtml += '<label>ΔT</label><input type="number" id="deltaT_cond" placeholder="in °C">';
        inputsHtml += '<label>Time (t)</label><input type="number" id="t_cond" placeholder="in seconds">';
        inputsHtml += '<label>Thickness (d)</label><input type="number" id="d" placeholder="in meters">';
      }
      document.getElementById("thermodynamicsInputs").innerHTML = inputsHtml;
    }
    function showMechanicsInputs() {
      const problemType = document.getElementById("mechanicsProblemSelect").value;
      let inputsHtml = "";
      if (problemType === "kinematic") {
        inputsHtml += '<label>Initial Velocity (u)</label><input type="number" id="u_kin" placeholder="in m/s">';
        inputsHtml += '<label>Acceleration (a)</label><input type="number" id="a_kin" placeholder="in m/s²">';
        inputsHtml += '<label>Time (t)</label><input type="number" id="t_kin" placeholder="in seconds">';
      } else if (problemType === "workenergy") {
        inputsHtml += '<label>Force (F)</label><input type="number" id="F_we" placeholder="in N">';
        inputsHtml += '<label>Distance (d)</label><input type="number" id="d_we" placeholder="in meters">';
      } else if (problemType === "newton2") {
        inputsHtml += '<label>Mass (m)</label><input type="number" id="m_n2" placeholder="in kg">';
        inputsHtml += '<label>Acceleration (a)</label><input type="number" id="a_n2" placeholder="in m/s²">';
      } else if (problemType === "energy") {
        inputsHtml += '<label>Mass (m)</label><input type="number" id="m_ke" placeholder="in kg">';
        inputsHtml += '<label>Velocity (v)</label><input type="number" id="v_ke" placeholder="in m/s">';
      } else if (problemType === "potential") {
        inputsHtml += '<label>Mass (m)</label><input type="number" id="m_pe" placeholder="in kg">';
        inputsHtml += '<label>Height (h)</label><input type="number" id="h_pe" placeholder="in meters">';
      }
      document.getElementById("mechanicsInputs").innerHTML = inputsHtml;
    }

    // Main solver function
    async function solveProblem() {
      const problemDescription = document.getElementById("problemDescription").value.trim();
      const problemImage = document.getElementById("problemImage").files[0];
      let stepsText = "";
      let resultText = "";
      if (problemDescription || problemImage) {
        await solveWithAI(problemDescription, problemImage);
        return;
      }

      const chapter = document.getElementById("chapterSelect").value;
      if (!chapter) {
        resultText = "Please select a chapter or provide a problem description/image.";
        showResult(resultText, "", true);
        return;
      }

      const problemType = document.getElementById(`${chapter}ProblemSelect`).value;
      if (!problemType) {
        resultText = "Please select a problem type.";
        showResult(resultText, "", true);
        return;
      }
      if (chapter === "optics") {
        if (problemType === "lens" || problemType === "mirror") {
          let u = parseFloat(document.getElementById("u").value);
          let v = parseFloat(document.getElementById("v").value);
          let f = parseFloat(document.getElementById("f").value);
          if (!isNaN(u) && !isNaN(v)) {
            f = 1 / ((1 / v) - (1 / u));
            stepsText = `<div class="step">Using 1/f = 1/v - 1/u</div><div class="step">1/f = 1/${v} - 1/${u}</div>`;
            resultText = `Focal length (f) = ${f.toFixed(2)} m`;
          } else if (!isNaN(u) && !isNaN(f)) {
            v = 1 / ((1 / f) + (1 / u));
            stepsText = `<div class="step">Using 1/v = 1/f + 1/u</div><div class="step">1/v = 1/${f} + 1/${u}</div>`;
            resultText = `Image distance (v) = ${v.toFixed(2)} m`;
          } else if (!isNaN(v) && !isNaN(f)) {
            u = 1 / ((1 / f) - (1 / v));
            stepsText = `<div class="step">Using 1/u = 1/f - 1/v</div><div class="step">1/u = 1/${f} - 1/${v}</div>`;
            resultText = `Object distance (u) = ${u.toFixed(2)} m`;
          } else {
            resultText = "Please provide two of: u, v, f.";
            stepsText = "";
        }
    } else if (problemType === "snell") {
          let n1 = parseFloat(document.getElementById("n1").value);
          let theta1 = parseFloat(document.getElementById("theta1").value);
          let n2 = parseFloat(document.getElementById("n2").value);
          let theta2 = parseFloat(document.getElementById("theta2").value);
          if (isNaN(n1) && !isNaN(theta1) && !isNaN(n2) && !isNaN(theta2)) {
            n1 = (n2 * Math.sin(theta2 * Math.PI / 180)) / Math.sin(theta1 * Math.PI / 180);
            stepsText = `<div class="step">Using n₁ sinθ₁ = n₂ sinθ₂</div><div class="step">n₁ = ${n2} sin(${theta2}) / sin(${theta1})</div>`;
            resultText = `n₁ = ${n1.toFixed(2)}`;
          } else if (isNaN(theta1) && !isNaN(n1) && !isNaN(n2) && !isNaN(theta2)) {
            theta1 = Math.asin((n2 * Math.sin(theta2 * Math.PI / 180)) / n1) * 180 / Math.PI;
            stepsText = `<div class="step">Using sinθ₁ = (n₂ sinθ₂) / n₁</div>`;
            resultText = `θ₁ = ${theta1.toFixed(2)}°`;
          } else {
            resultText = "Provide three of: n₁, θ₁, n₂, θ₂.";
          }
        } else if (problemType === "magnification") {
          let v = parseFloat(document.getElementById("v_mag").value);
          let u = parseFloat(document.getElementById("u_mag").value);
          if (!isNaN(v) && !isNaN(u)) {
            let m = -v / u;
            stepsText = `<div class="step">Using m = -v/u</div><div class="step">m = -${v} / ${u}</div>`;
            resultText = `Magnification (m) = ${m.toFixed(2)}`;
          } else {
            resultText = "Please provide v and u.";
          }
        } else if (problemType === "lensmaker") {
          let n = parseFloat(document.getElementById("n_lens").value);
          let R1 = parseFloat(document.getElementById("R1").value);
          let R2 = parseFloat(document.getElementById("R2").value);
          if (!isNaN(n) && !isNaN(R1) && !isNaN(R2)) {
            let f = 1 / ((n - 1) * ((1 / R1) - (1 / R2)));
            stepsText = `<div class="step">Using 1/f = (n-1)(1/R₁ - 1/R₂)</div>`;
            resultText = `Focal length (f) = ${f.toFixed(2)} m`;
          } else {
            resultText = "Please provide n, R₁, and R₂.";
          }
        }
      } else if (chapter === "electricity") {
        if (problemType === "ohm") {
          let V = parseFloat(document.getElementById("V").value);
          let I = parseFloat(document.getElementById("I").value);
          let R = parseFloat(document.getElementById("R").value);
          if (!isNaN(V) && !isNaN(I)) {
            R = V / I;
            stepsText = `<div class="step">Using V = IR</div><div class="step">R = ${V} / ${I}</div>`;
            resultText = `Resistance (R) = ${R.toFixed(2)} Ω`;
          } else if (!isNaN(V) && !isNaN(R)) {
            I = V / R;
            stepsText = `<div class="step">Using I = V/R</div>`;
            resultText = `Current (I) = ${I.toFixed(2)} A`;
          } else if (!isNaN(I) && !isNaN(R)) {
            V = I * R;
            stepsText = `<div class="step">Using V = IR</div>`;
            resultText = `Voltage (V) = ${V.toFixed(2)} V`;
          } else {
            resultText = "Provide two of: V, I, R.";
          }
        } else if (problemType === "power") {
          let V = parseFloat(document.getElementById("V_pow").value);
          let I = parseFloat(document.getElementById("I_pow").value);
          if (!isNaN(V) && !isNaN(I)) {
            let P = V * I;
            stepsText = `<div class="step">Using P = VI</div>`;
            resultText = `Power (P) = ${P.toFixed(2)} W`;
          } else {
            resultText = "Provide V and I.";
          }
        } else if (problemType === "series") {
          let R1 = parseFloat(document.getElementById("R1_ser").value);
          let R2 = parseFloat(document.getElementById("R2_ser").value);
          if (!isNaN(R1) && !isNaN(R2)) {
            let R_total = R1 + R2;
            stepsText = `<div class="step">Using R_total = R₁ + R₂</div>`;
            resultText = `Total Resistance = ${R_total.toFixed(2)} Ω`;
          } else {
            resultText = "Provide R₁ and R₂.";
          }
        } else if (problemType === "parallel") {
          let R1 = parseFloat(document.getElementById("R1_par").value);
          let R2 = parseFloat(document.getElementById("R2_par").value);
          if (!isNaN(R1) && !isNaN(R2)) {
            let R_total = 1 / ((1 / R1) + (1 / R2));
            stepsText = `<div class="step">Using 1/R_total = 1/R₁ + 1/R₂</div>`;
            resultText = `Total Resistance = ${R_total.toFixed(2)} Ω`;
          } else {
            resultText = "Provide R₁ and R₂.";
          }
        }
      } else if (chapter === "thermodynamics") {
        if (problemType === "newton") {
          let T_ambient = parseFloat(document.getElementById("T_ambient").value);
          let T0 = parseFloat(document.getElementById("T0").value);
          let k = parseFloat(document.getElementById("k").value);
          let t = parseFloat(document.getElementById("time").value);
          if (!isNaN(T_ambient) && !isNaN(T0) && !isNaN(k) && !isNaN(t)) {
            let T = T_ambient + (T0 - T_ambient) * Math.exp(-k * t);
            stepsText = `<div class="step">Using T(t) = Tₐ + (T₀ - Tₐ)e^(-kt)</div>`;
            resultText = `Temperature (T) = ${T.toFixed(2)} °C`;
          } else {
            resultText = "Provide Tₐ, T₀, k, and t.";
          }
